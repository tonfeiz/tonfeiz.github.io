---
title: Twelve Factor Part IV
date: "2019-04-30"
summary: "Dev/prod parity; Logs; Admin processes" 
---
Dev/prod parity  
Logs  
Admin processes


## 十、开发环境/生产环境相同
保持开发环境、模拟环境和生产环境尽可能相似  

历史上，在开发环境和生产环境之间有三道鸿沟，分别位：  
* 时间：开发者可能在需要花费几天甚至几个月才运行的代码上工作  
* 人事：开发者写代码，运维工程师部署它  
* 工具：开发者使用Nginx，SQLite和OSX而实际生产环境可能是Apache，MySQL和Linux  

twelve-factor app需要使上面三者尽可能小来便于持续部署。  

以后台服务(backing services)为例，很多语言提供库来简化与其的通信，例如使用适配器使其能适配不同的数据库。有时候开发者会倾向于在本地使用轻量级的数据库而在正式部署时使用重量级的数据库。  

twelve-factor app的开发者拒绝在开发环境和生产环境之间使用不同的后台服务。  

对不同后台服务的适配仍然是有用的，例如在改变后台服务时。但app的所有部署(开发环境，模拟环境和生产环境)都应当具有相同版本的后台服务  

## 十一、日志
将日志当做事件流对待  

日志提供了运行app的行为事件。它是从所有的进程和后台服务中得到的聚合的、按时间顺序排列的流。  

一个twelve factor app从不关心输出流的路由或是存储。它不应当写日志文件或者管理它们。每个运行的进程都只是将事件流写入`stdout`中。  

在开发环境中，开发者通过终端的流观察app的行为。在模拟或生产环境中，每个进程的流将被执行环境捕捉，并被路由到一个或多个最终目的地来作为长期文件。这些文件对于app是不可见并不可配置的，完全由执行环境来管理。  

app的事件流还可以被送到日志索引和分析系统，例如Splunk，或是一个通用目的的存储系统例如Hadoop/Hive。这些系统能提供更多的功能  

## 十二、管理进程
将管理进程作为一次性的、不是经常开关的进程  

开发者经常希望有一个一次性的管理进程，例如：  
* 运行数据库迁移  
* 运行一个控制台  
* 运行上传到app repo中的一次性脚本  

一次性的管理进程应当和app的常规长时运行进程运行在同一个环境下，使用相同的代码库和配置，不需要进行同步措施。  


