---
title: Data Plane & Control Plane
date: "2019-06-26"
summary: "这篇文章介绍了数据面和控制面之间的差别。原文是[Service mesh data plane vs. control plane](https://blog.envoyproxy.io/service-mesh-data-plane-vs-control-plane-2774e720f7fc)" 
---
这篇文章介绍了数据面和控制面之间的差别。原文是[Service mesh data plane vs. control plane](https://blog.envoyproxy.io/service-mesh-data-plane-vs-control-plane-2774e720f7fc)  

首先，作者简单介绍了service mesh。在Service mesh中，每个服务有一个sidecar代理。所有的网络流量都通过该代理流到特定地点。服务本身不会知道网络分布，而只知道代理。也就是说，分布式系统网络对服务编写人员来说是不用知道的。  

## 数据面(data plane)
接下来，作者介绍了数据面(data plane)。数据面其实就是sidecar代理。sidecar代理通常要完成的工作包括：  
* 服务发现：有哪些上游服务实例是可用的？  
* 健康检查：通过服务发现找到的上游服务实例是健康的吗？它们准备好接收网络流量了吗？这可能包括主动(例如，带外ping某个端点)和被动(例如，连续3个5xx回应表示不健康状态)健康检查。  
* 路由：本地服务给出了一个REST请求，该把这个请求送到哪个上游服务实例？  
* 负载均衡：当上游服务实例被选定后，请求该送到哪个服务实例？超时时间是多少？熔断设置怎么样？  
* 认证：对于到来的请求，调用者能通过mTLS或其他机制被秘密的认证吗？  
* 观测性：对于每个请求，统计数据，日志和分布式跟踪数据应当被生成。  

数据面被用于有条件的翻译、转发和观察每个流入和流出的网络包。  

## 控制面(control plane)
作者指出，控制面将一些独立的无状态sidecar代理整合起来并将它们变为分布式系统。  

大部分人自身就是控制面。人们自己手动写出静态的配置，并将它们部署到所有的代理上。代理使用这些配置并用数据面处理。  

目前出现了高级的控制面。高级的控制面可以包括控制面UI、工作调度器(例如Kubernetes)、服务发现系统(当调度器启动或停止实例则向该系统汇报)和sidecar代理配置API等。  

最终，控制面的目的还是设置将要被数据面执行的政策。  

## 总结
* 数据面：与系统中的每个包/请求接触。对服务发现、健康检查、路由、负载均衡、认证和观测性负责  
* 控制面：为运行着的数据面提供政策和配置。不接触系统中的请求/包。控制面将所有的数据面转化为分布式系统。  
